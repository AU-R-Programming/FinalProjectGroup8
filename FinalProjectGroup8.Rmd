---
title: "FinalProjectGroup8"
author: "Lynn, Yu & Matthew"
date: "11/2/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Final Project

Development of an R package implementing linear regression

The basic outputs to be included must include:

1. Confidence Intervals-The user must be able to select the alpha values and whether to use a bootstrap or asymptotic approach

2. Plots including: 
  a. Residuals vs. fitted-values
  b. qq-plot of residuals
  c. Histogram (or density) of residuals
3. Mean Square Prediction Error (MSPE) computed in matrix form
4. F-test
5. Help documentation for all functions

Up to 20 bonus points are available if other features are added for the package.

```{r}
#Set up the linear regression as a function
my_lm = function(response, covariates, alpha = 0.05) {
  
# Make sure data formats are appropriate
response <- as.vector(response)
covariates <- as.matrix(covariates)
  
# Define parameters
n <- length(response)
p <- dim(covariates)[2]
df <- n - p
  
# Estimate beta through Eq. (6.1 provided in the book)
beta.hat <- solve(t(covariates)%*%covariates)%*%t(covariates)%*%response
  
# Estimate of the residual variance (sigma2) from Eq.(6.3 provided in the book)
# Compute residuals
resid <- response - covariates%*%as.matrix(beta.hat) 
sigma2.hat <- (1/df)*t(resid)%*%resid
  
# Estimate of the variance of the estimated beta from Eq. (6.2)
var.beta <- sigma2.hat*solve(t(covariates)%*%covariates)
  
# Estimate of the confidence interval based on alpha
#THIS NEEDS TO CHANGE, THE DEFAULT IS SET TO .05
quant <- 1 - alpha/2
ci.beta <- c(beta.hat - qnorm(p = quant)*sqrt(var.beta), beta.hat + 
                 qnorm(p = quant)*sqrt(var.beta))
  
# Return all estimated values
return(list(beta = beta.hat, sigma2 = sigma2.hat,variance_beta = var.beta, ci = ci.beta))
}
```

```{r}
#Set up the plots by first using ggplot2
library(ggplot2)

#define fitted values
#STRUGGLING HERE
fitted<-X*bet.hat
```
```{r}
#Make a qq plot of residuals
#STRUGGLING HERE TOO
qqplot(resid)
```

``` {r}
#Make a histogram (or density) of residuals
#YEAH NOTHING WORKS-I AM DEFINITELY THINKING ABOUT THIS THE WRONG WAY
hist(resid)
```
